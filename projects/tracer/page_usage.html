<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>TracerJD: TracerJD Usage</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="index.html">TracerJD: A Framework for Generic Trace-based Dynamic Dependence Analysis with Fine-grained Logging</a>
  </div>
</div>
<div class="contents">


<h1><a class="anchor" id="page_usage">TracerJD Usage </a></h1><h2><a class="anchor" id="usage_tracer">
How to use TracerJD</a></h2>
<h3><a class="anchor" id="tracer_prerequisite">
Before using running TracerJD analyses</a></h3>
<p>In order for tracer to instrument the bytecode of the target subject, adding certain statements in the subject source code is needed. In this regard however, tracer requires the addition of statements into the main/entry class of the subject program only.</p>
<p>Precisely, the following statements should be added to the entry class, which is essentially an extra static method that allows the static analysis (Soot phase, more precisely) to include the TracerJD runtime monitors in its bytecode analysis. </p>
<pre>
public class TheEntryClass {
	......
	// added for tracer Instrumentation
	static void __link() {
		profile.EvenMonitor.__link(); 
	}
	......
</pre><p>Then, follow the steps below:</p>
<p>(1) Compile the subject with the above extra code added.</p>
<ul>
<li>similar to how you compile the original (uninstrumented) subject program, just add extra class paths for tracer and its library dependencies.</li>
<li>An actual example script is given below; you just need to accommodate the variables to your own environment. <div class="fragment"><pre class="fragment">
ver=$1
seed=$2
ROOT=/home/hcai/
subjectloc=/home/hcai/SVNRepos/star-lab/trunk/Subjects/Schedule1/
mkdir -p $subjectloc/bin/${ver}${seed}
javac -cp $subjectloc/lib/:libs/DUAForensics.jar:libs/InstrReporters.jar:libs/deam.jar:libs/Sensa.jar:libs/mcia.jar:TracerJD.jar  \
	-g:source -nowarn \
	-source 1.4 \
	-d $subjectloc/bin/${ver}${seed} \
	$subjectloc/src/${ver}${seed}/ScheduleClass.java
</pre></div></li>
</ul>
<p>(2) Instrument logging probes for runtime tracing</p>
<ul>
<li>An actual example script is given below; you just need to accommodate the variables to your own environment. <div class="fragment"><pre class="fragment">
ver=$1
seed=$2
ROOT=/home/hcai/
subjectloc=/home/hcai/SVNRepos/star-lab/trunk/Subjects/Schedule1/

MAINCP=".:libs/polyglot.jar:libs/sootclasses-2.3.0.jar:libs/jasminclasses-2.3.0.jar:libs/java_cup.jar:libs/LocalsBox.jar:$subjectloc/lib:libs/DUAForensics.jar:libs/InstrReporters.jar:libs/deam.jar:libs/Sensa.jar:libs/mcia.jar:TracerJD.jar"

mkdir -p $subjectloc/out-TracerInstr

#SOOTCP=.:/etc/alternatives/java_sdk/jre/lib/rt.jar:/etc/alternatives/java_sdk/jre/lib/jce.jar:
SOOTCP=".:libs/rt.jar:libs/polyglot.jar:libs/sootclasses-2.3.0.jar:libs/jasminclasses-2.3.0.jar:libs/java_cup.jar:libs/LocalsBox.jar:$subjectloc/lib:libs/DUAForensics.jar:libs/InstrReporters.jar:libs/deam.jar:libs/Sensa.jar:libs/mcia.jar:TracerJD.jar:$subjectloc/lib:$subjectloc/bin/${ver}${seed}"

OUTDIR=$subjectloc/tracerInstrumented-$ver$seed
mkdir -p $OUTDIR

starttime=`date +%s%N | cut -b1-13`
	#-debug \
	#-dumpJimple \
	#-wrapTryCatch \
   	#-duaverbose \
	#-dumpFunctionList \
	#-debug \
$JAVA -Xmx1600m -ea -cp ${MAINCP} profile.EventInstrumenter \
	-w -cp ${SOOTCP} \
	-p cg verbose:false,implicit-entry:false -p cg.spark verbose:false,on-fly-cg:true,rta:true \
	-f c -d "$OUTDIR" -brinstr:off -duainstr:off \
	-wrapTryCatch \
	-slicectxinsens \
	-notracingval \
	-allowphantom \
	-staticCDInfo \
	-main-class ${DRIVERCLASS} -entry:${DRIVERCLASS} \
	-process-dir $subjectloc/bin/${ver}${seed}  \
	1&gt;$subjectloc/out-TracerInstr/instr-${ver}${seed}.out 2&gt;$subjectloc/out-TracerInstr/instr-${ver}${seed}.err
stoptime=`date +%s%N | cut -b1-13`
echo "StaticAnalysisTime for ${ver}${seed} elapsed: " `expr $stoptime - $starttime` milliseconds

</pre></div></li>
</ul>
<p>(3) Run the instrumented code to generate dependence traces.</p>
<ul>
<li>Similar to how you run the original (uninstrumented) subject program, just add extra class paths for tracer and its library dependencies.</li>
<li>An actual example script is given below; you just need to accommodate the variables to your own environment. <div class="fragment"><pre class="fragment">
ver=$1
seed=$2
NT=${3:-"5"} % number of inputs to use
ROOT=/home/hcai/
subjectloc=/home/hcai/SVNRepos/star-lab/trunk/Subjects/Schedule1/

INDIR=$subjectloc/tracerInstrumented-$ver$seed

MAINCP=".:libs/polyglot.jar:libs/sootclasses-2.3.0.jar:libs/jasminclasses-2.3.0.jar:libs/java_cup.jar:libs/LocalsBox.jar:$subjectloc/lib:libs/DUAForensics.jar:libs/InstrReporters.jar:libs/deam.jar:libs/Sensa.jar:libs/mcia.jar:TracerJD.jar:$subjectloc/lib:$INDIR"

starttime=`date +%s%N | cut -b1-13`

	#"-fullseq" 
java -Xmx1600m -ea -cp ${MAINCP} trace.Runner \
	"$subjectloc" \
	${ver}${seed} \
	$DRIVERCLASS \
	$NT \
	-caching

stoptime=`date +%s%N | cut -b1-13`
echo "RunTime for ${ver}${seed} elapsed: " `expr $stoptime - $starttime` milliseconds
cp $INDIR/{varIds.out,staticCDInfo.dat,stmtids.out} $subjectloc/tracerOutdyn-${ver}${seed}/

</pre></div></li>
</ul>
<p>(4) Dynamic dependence querying interface and client analyses</p>
<ul>
<li>Included as part of the TracerJD tracing framework is a small set of unit tests of such interface (dynamic dependence querying routines)</li>
<li>The following script illustrates how to run the unit test suite (to make sure the framework works before you want to develop and run client analyses on TracerJD) <div class="fragment"><pre class="fragment">
ver=$1
seed=$2
NT=${1:-"5"} % number of inputs to use
ROOT=/home/hcai/
subjectloc=/home/hcai/SVNRepos/star-lab/trunk/Subjects/Schedule1/

INDIR=$subjectloc/tracerOutdyn-${ver}${seed}

MAINCP=".:libs/polyglot.jar:libs/sootclasses-2.3.0.jar:libs/jasminclasses-2.3.0.jar:libs/java_cup.jar:libs/LocalsBox.jar:$subjectloc/lib:libs/DUAForensics.jar:libs/InstrReporters.jar:libs/deam.jar:libs/Sensa.jar:libs/mcia.jar:TracerJD.jar:$subjectloc/lib"

starttime=`date +%s%N | cut -b1-13`
	#"main" \
java -Xmx1800m -ea -cp ${MAINCP} trace.TraceAnalysis \
	"$INDIR" \
	$NT \
	#-debug

stoptime=`date +%s%N | cut -b1-13`
echo "RunTime for ${ver}${seed} elapsed: " `expr $stoptime - $starttime` milliseconds

</pre></div> </li>
</ul>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated on 3 Dec 2014 for TracerJD by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
